<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>
      
        Nix Syntax Primer
      
    </title>
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="../../css/main.css">
  </head>

  <body>

    <div class="page-wrap">
      <div class="header-wrap">
        <div class="header" role="page-header">
          <h1 class="site-title-wrap">
            <a rel="home" href="../../" title="Ryan Artecona">
              <span class="logo-wrap">
                <span class="logo-background">
                  <img class="logo" src="../../images/RA_logo.png" alt="Ryan Artecona" />
                </span>
              </span>
              <span class="site-title">
                Ryan Artecona
              </span>
            </a>
          </h1>
          <div class="nav" role="navigation">
            <ul class="nav-items">
              <li class="nav-item current">
                <a href="../../">Posts</a>
              </li>
              <li class="nav-item">
                <a href="../../about">About</a>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="page-main">
        <div class="page-content">
          <div class="article">
  <div class="entry-header">
    <h2 class="entry-title">
      Nix Syntax Primer
    </h2>
  </div>

  <div class="entry-meta">
    <span class="entry-meta-item entry-date">
      January  9, 2017
    </span>
    
  </div>

  <div class="entry-content">
    <p>[intro]</p>
<h2 id="preliminaries">Preliminaries</h2>
<h3 id="running-the-examples">Running the examples</h3>
<ul>
<li><code>nix-repl</code></li>
<li><code>nix-instantiate --eval --expr '...'</code></li>
<li>https://nixcloud.io/tour</li>
</ul>
<h2 id="json-types">JSON types</h2>
<p>Nix has most of the same primitive value types as JSON, namely: numbers, booleans, strings, and <code>null</code>. One notable exception is that Nix does not have floats, so all numbers are integers.</p>
<div class="highlight"><pre><span class="mi">4</span> <span class="c1">#-&gt; 4</span>
<span class="no">true</span> <span class="c1">#-&gt; true</span>
<span class="s2">&quot;str&quot;</span> <span class="c1">#-&gt; &quot;str&quot;</span>
<span class="no">null</span> <span class="c1">#-&gt; null</span>
</pre></div>

<p>Also like JSON, Nix has arrays and objects, albeit with slightly different syntax. Note that what JSON calls “objects”, Nix calls “attribute sets”.</p>
<div class="highlight"><pre><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span> <span class="c1">#-&gt; [1, 2, 3]</span>
<span class="p">{</span><span class="ss">foo =</span> <span class="s2">&quot;bar&quot;</span><span class="p">;</span> <span class="ss">baz =</span> <span class="s2">&quot;quux&quot;</span><span class="p">;}</span> <span class="c1">#-&gt; {&quot;foo&quot;: &quot;bar&quot;, &quot;baz&quot;: &quot;quuz&quot;}</span>
</pre></div>

<h2 id="functions">functions</h2>
<p>Basic function syntax is quite terse: you have an argument on the left and a function body on the right separated only by a <code>:</code>. It’s easy to miss if you’re not looking for it.</p>
<p>Here is a function which simply adds <code>1</code> to its argument.</p>
<div class="highlight"><pre>x<span class="p">:</span> x <span class="o">+</span> <span class="mi">1</span>
</pre></div>

<p>To apply a function to an argument, simply place the argument after the function.</p>
<div class="highlight"><pre><span class="k">let</span>
  <span class="ss">add1 =</span> <span class="p">(</span>x<span class="p">:</span> x <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">in</span>
  add1 <span class="mi">2</span>
</pre></div>

<p>All functions in Nix take exactly 1 argument (they’re “unary”).</p>
<p>This isn’t a limitation, since we can get something that looks and behaves like a multi-argument function by writing it in a curried style: you write a function which takes the first argument, and it returns <em>another</em> function which takes the next argument, and when you have all your arguments in scope you can return the real result of the function.</p>
<div class="highlight"><pre><span class="p">(</span>x<span class="p">:</span> <span class="p">(</span>y<span class="p">:</span> x <span class="o">+</span> y<span class="p">))</span>
</pre></div>

<p>You can drop those parentheses without changing how the expression is grouped, which makes curried functions easier to read and write.</p>
<div class="highlight"><pre>x<span class="p">:</span> y<span class="p">:</span> x <span class="o">+</span> y
</pre></div>

<p>(The <code>:</code> in a function definition is “right associative”.)</p>
<p>To use a curried function, simply supply all the arguments.</p>
<div class="highlight"><pre><span class="k">let</span>
  <span class="ss">add =</span> <span class="p">(</span>x<span class="p">:</span> y<span class="p">:</span> x <span class="o">+</span> y<span class="p">);</span>
<span class="k">in</span>
  add <span class="mi">1</span> <span class="mi">2</span>
</pre></div>

<p>(Function application is “left associative”.)</p>
<p>Functions can also pattern match on attribute set arguments.</p>
<div class="highlight"><pre><span class="p">{</span>x<span class="p">,</span> y<span class="p">}:</span> x <span class="o">+</span> y
</pre></div>

<p>This is often used to approximate named function arguments.</p>
<div class="highlight"><pre><span class="k">let</span>
  <span class="ss">add =</span> <span class="p">({</span>x<span class="p">,</span> y<span class="p">}:</span> x <span class="o">+</span> y<span class="p">);</span>
<span class="k">in</span>
  add <span class="p">{</span><span class="ss">x =</span> <span class="mi">1</span><span class="p">;</span> <span class="ss">y =</span> <span class="mi">2</span><span class="p">;}</span>
</pre></div>

<p>Note that such a function requires an attribute set which has <em>exactly</em> the keys used in the pattern. Missing or unexpected keys will cause an error.</p>
<p>To allow extra keys, which will be ignored, you can mention <code>...</code>.</p>
<div class="highlight"><pre><span class="k">let</span>
  <span class="ss">hello =</span> <span class="p">({</span>name<span class="p">,</span> <span class="o">...</span><span class="p">}:</span> <span class="s2">&quot;Hello </span><span class="si">${</span>name<span class="si">}</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="k">in</span>
  hello <span class="p">{</span><span class="ss">name =</span> <span class="s2">&quot;world&quot;</span><span class="p">;</span> <span class="ss">x =</span> <span class="no">null</span><span class="p">;}</span>
</pre></div>

<p>To allow missing keys, you can give them default values with <code>?</code>.</p>
<div class="highlight"><pre><span class="k">let</span>
  <span class="ss">hello =</span> <span class="p">({</span>name <span class="o">?</span> <span class="s2">&quot;world&quot;</span><span class="p">}:</span> <span class="s2">&quot;Hello </span><span class="si">${</span>name<span class="si">}</span><span class="s2">&quot;</span><span class="p">);</span>
<span class="k">in</span>
  hello <span class="p">{}</span>
</pre></div>

<h2 id="variables-and-scopes">variables and scopes</h2>
<div class="highlight"><pre><span class="k">let</span> <span class="ss">x =</span> <span class="s2">&quot;value&quot;</span><span class="p">;</span> <span class="k">in</span> <span class="p">{</span><span class="ss">key =</span> x<span class="p">;}</span>

<span class="k">let</span> <span class="ss">x =</span> <span class="p">{</span><span class="ss">item =</span> <span class="s2">&quot;value&quot;</span><span class="p">;};</span> <span class="k">in</span> <span class="p">(</span><span class="k">with</span> x<span class="p">;</span> item<span class="p">)</span>
</pre></div>

<h2 id="attribute-sets">attribute sets</h2>
<p>(like JSON’s “Object”, Ruby’s “Hash”, Python’s “dict”, etc., but with an obscure name)</p>
<div class="highlight"><pre><span class="k">let</span> <span class="ss">x =</span> <span class="p">{</span><span class="ss">key =</span> <span class="s2">&quot;value&quot;</span><span class="p">;};</span> <span class="k">in</span> x<span class="o">.</span>key

<span class="k">let</span> <span class="ss">name =</span> <span class="s2">&quot;key&quot;</span><span class="p">;</span> <span class="ss">x =</span> <span class="p">{</span><span class="s2">&quot;</span><span class="si">${</span>name<span class="si">}</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">;};</span> <span class="k">in</span> x<span class="o">.</span><span class="s2">&quot;</span><span class="si">${</span>name<span class="si">}</span><span class="s2">&quot;</span>

<span class="k">let</span> <span class="ss">x =</span> <span class="mi">1</span><span class="p">;</span> <span class="ss">y =</span> <span class="mi">2</span><span class="p">;</span> <span class="k">in</span> <span class="p">{</span><span class="k">inherit</span> x y<span class="p">;}</span>

<span class="k">let</span> <span class="ss">attrset =</span> <span class="p">{</span><span class="ss">x =</span> <span class="mi">1</span><span class="p">;</span> <span class="ss">y =</span> <span class="mi">2</span><span class="p">;};</span> <span class="k">in</span> <span class="p">{</span><span class="k">inherit</span> <span class="p">(</span>attrset<span class="p">)</span> x y<span class="p">;}</span>

<span class="k">let</span> <span class="ss">foo =</span> <span class="p">{</span><span class="ss">x =</span> <span class="mi">1</span><span class="p">;};</span> <span class="ss">bar =</span> <span class="p">{</span><span class="ss">y =</span> <span class="mi">2</span><span class="p">;};</span> <span class="k">in</span> <span class="p">(</span>foo <span class="o">//</span> bar<span class="p">)</span>
</pre></div>

<h2 id="strings">strings</h2>
<div class="highlight"><pre><span class="s2">&quot;str&quot;</span>

<span class="k">let</span> <span class="ss">name =</span> <span class="s2">&quot;foo&quot;</span><span class="p">;</span> <span class="k">in</span> <span class="s2">&quot;</span><span class="si">${</span>name<span class="si">}</span><span class="s2">&quot;</span>

<span class="k">let</span> <span class="ss">name =</span> <span class="s2">&quot;world&quot;</span><span class="p">;</span> <span class="k">in</span>
<span class="s1">''</span>
<span class="s1">  # This can be any text, like a bash script</span>
<span class="s1">  echo &quot;Hello </span><span class="si">${</span>name<span class="si">}</span><span class="s1">&quot;</span>
<span class="se">''</span>

<span class="s1">let name = &quot;world&quot;; in &quot;Hello &quot; + name</span>
</pre></div>

<h2 id="paths">paths</h2>
<div class="highlight"><pre><span class="k">let</span> <span class="ss">path =</span> <span class="o">.</span><span class="l">/config.yml</span><span class="p">;</span> <span class="k">in</span> <span class="s2">&quot;</span><span class="si">${</span>path<span class="si">}</span><span class="s2">&quot;</span>
</pre></div>

<div class="highlight"><pre>nix-instantiate -I <span class="nv">mypath</span><span class="o">=</span>./ --eval <span class="s2">&quot;&lt;mypath&gt;&quot;</span>
</pre></div>

  </div>
</div>

        </div>
      </div>

    </div>

  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28816340-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </body>
</html>
